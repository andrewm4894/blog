<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Favicon -->
    <link rel="icon" type="image/png" href="/preview/dummy-feature-branch/assets/images/favicon.png">
    <link rel="shortcut icon" type="image/png" href="/preview/dummy-feature-branch/assets/images/favicon.png">
    <link rel="apple-touch-icon" href="/preview/dummy-feature-branch/assets/images/favicon.png">

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Source+Sans+Pro:ital,wght@0,400;0,600;1,400;1,600&family=JetBrains+Mono:ital,wght@0,400;0,500;1,400;1,500&display=swap" rel="stylesheet">

    <title>Multi-Variate, Multi-Step, LSTM for Anomaly Detection | andrewm4894.com</title>
    <link rel="stylesheet" href="/preview/dummy-feature-branch/assets/css/style.css?v=20250802145510">
    
    <!-- PostHog Analytics -->
    <script>
        !function(t,e){var o,n,p,r;e.__SV||(window.posthog=e,e._i=[],e.init=function(i,s,a){function g(t,e){var o=e.split(".");2==o.length&&(t=t[o[0]],e=o[1]),t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}}(p=t.createElement("script")).type="text/javascript",p.crossOrigin="anonymous",p.async=!0,p.src=s.api_host.replace(".i.posthog.com","-assets.i.posthog.com")+"/static/array.js",(r=t.getElementsByTagName("script")[0]).parentNode.insertBefore(p,r);var u=e;for(void 0!==a?u=e[a]=[]:a="posthog",u.people=u.people||[],u.toString=function(t){var e="posthog";return"posthog"!==a&&(e+="."+a),t||(e+=" (stub)"),e},u.people.toString=function(){return u.toString(1)+".people (stub)"},o="init Re Cs Fs Pe Rs Ms capture Ve calculateEventProperties Ds register register_once register_for_session unregister unregister_for_session zs getFeatureFlag getFeatureFlagPayload isFeatureEnabled reloadFeatureFlags updateEarlyAccessFeatureEnrollment getEarlyAccessFeatures on onFeatureFlags onSurveysLoaded onSessionId getSurveys getActiveMatchingSurveys renderSurvey canRenderSurvey canRenderSurveyAsync identify setPersonProperties group resetGroups setPersonPropertiesForFlags resetPersonPropertiesForFlags setGroupPropertiesForFlags resetGroupPropertiesForFlags reset get_distinct_id getGroups get_session_id get_session_replay_url alias set_config startSessionRecording stopSessionRecording sessionRecordingStarted captureException loadToolbar get_property getSessionProperty js As createPersonProfile Ns Is Us opt_in_capturing opt_out_capturing has_opted_in_capturing has_opted_out_capturing clear_opt_in_out_capturing Os debug I Ls getPageViewId captureTraceFeedback captureTraceMetric".split(" "),n=0;n<o.length;n++)g(u,o[n]);e._i.push([i,s,a])},e.__SV=1)}(document,window.posthog||[]);
        posthog.init('zR4pStMtxgP3wJ27vIjQJvZNXwMWqZlzP0x4dKbHOHg', {
            api_host: 'https://us.i.posthog.com',
            defaults: '2025-05-24',
            person_profiles: 'identified_only', // or 'always' to create profiles for anonymous users as well
        })
    </script>
    
  </head>
  <body>
    <div class="wrapper" style="display: flex; max-width: 1200px; margin: 0 auto; padding: 0 20px;">
      <!-- Main content -->
      <section style="flex: 1; max-width: 800px; margin-right: 40px;">
        <div style="margin-bottom: 2em;">
          <a href="/preview/dummy-feature-branch/" style="display: inline-block; padding: 0.5em 1em; background: #f5f5f5; border-radius: 4px; text-decoration: none; color: #333;">
            ← Back to Home
          </a>
        </div>

        

        <h1>Multi-Variate, Multi-Step, LSTM for Anomaly Detection</h1>

        <p class="post-meta">
          <time datetime="2019-09-09T00:00:00+00:00">Sep 9, 2019
          </time><span class="categories">
            • Categories: 
            
            <span class="category">machine-learning</span>
            
            
          </span></p>

        <p>This post will walk through a synthetic example illustrating one way to use a multi-variate, multi-step <a href="https://en.wikipedia.org/wiki/Long_short-term_memory">LSTM</a> for anomaly detection.</p>

<p>Imagine you have a matrix of <strong>k time series</strong> data coming at you at regular intervals and you look at the last <strong>n observations</strong> for each metric.</p>

<figure>

  <p><img src="/assets/images/2019-09-09-multi-variate-multi-step-lstm-for-anomaly-detection/1_KJE0RC7793B8qPLWadDqVg.png" alt="" /></p>

  <figcaption>

    <p>A matrix of 5 metrics from period t to t-n</p>

  </figcaption>

</figure>

<p>One approach to doing anomaly detection in such a setting is to build a model to predict each metric over each time step in your forecast horizon and when you notice your prediction errors start to change significantly this can be a sign of some anomalies in your incoming data.</p>

<p>This is essentially an unsupervised problem that can be converted into a supervised one. You train the model to predict its own training data. Then once it gets good at this (assuming your training data is relatively typical of normal behavior of your data), if you see some new data for which your prediction error is much higher then expected, that can be a sign that you new data is anomalous in some way.</p>

<p><em>Note: This example is adapted and built off of</em> <a href="https://developer.ibm.com/tutorials/iot-deep-learning-anomaly-detection-5/"><em>this tutorial</em></a> <em>which i found a very useful starting point. All the code for this post is in</em> <a href="https://github.com/andrewm4894/keras_learn/blob/master/lstm_multi.ipynb"><em>this notebook</em></a><em>. The rest of this post will essentially walk though the code.</em></p>

<h2 id="imports--paramaters">Imports &amp; Paramaters</h2>

<p>Below shows the imports and all the parameters for this example, you should be able to play with them and see what different results you get.</p>

<p><em>Note: There is a</em> <a href="https://github.com/andrewm4894/keras_learn/blob/master/Pipfile"><em>Pipfile here</em></a> <em>that shows the Python libraries needed. If you are not familiar, you should really check out</em> <a href="https://pipenv.readthedocs.io/en/latest/basics/https://pipenv.readthedocs.io/en/latest/basics/"><em>pipenv</em></a><em>, its really useful once you play with it a bit.</em></p>

<p>https://gist.github.com/andrewm4894/4540e23d86fa02859191a38998661849#file-keras_lstm_multi_imports_and_params-py</p>

<h2 id="fake-data">Fake Data!</h2>

<p>We will generate some random data, and then smooth it out to look realistic. This will be our <strong>‘normal’ data</strong> that we will use to train the model.</p>

<figure>

  <p><img src="/assets/images/2019-09-09-multi-variate-multi-step-lstm-for-anomaly-detection/1_HyFQhws3uVNRxYN6jBIzCw.jpeg" alt="" /></p>

  <figcaption>

    <p>I couldn’t help myself.</p>

  </figcaption>

</figure>

<p>Then we will make a copy of this normal data and inject in some random noise at a certain point and for a period of time. This will be our <strong>‘broken’ data</strong>.</p>

<p>So this ‘broken’ data is the data that we should see the model struggle with in terms of prediction error. It’s this error (aggregated and summarized in some way, e.g. turned into a z-score) that you could then use to drive an anomaly score (you could also use loss from the continually re-training on new data whereby the training loss should initially spike once the broken data comes into the system but over time the training would then adapt the model to the new data).</p>

<p>https://gist.github.com/andrewm4894/417f54744ccf1e8a909c9e373abd21fd#file-keras_lstm_multi_generate_fake_data_normal-py</p>

<p>This gives us our normal-ish real word looking data that we will use to train the model.</p>

<figure>

  <p><img src="/assets/images/2019-09-09-multi-variate-multi-step-lstm-for-anomaly-detection/1_pJdOGJ3WMJy1qCcqbr6Rww.jpeg" alt="" /></p>

  <figcaption>

    <p>5 random time series that have been smoothed a bit to look realistic.</p>

  </figcaption>

</figure>

<p>To make our ‘broken’ data (called data_new in the code) i lazily just copy the ‘normal’ data but mess up a segment of it with some random noise.</p>

<p>https://gist.github.com/andrewm4894/62174bbf299ecb36cada254314290644#file-keras_lstm_multi_generate_fake_data_broken-py</p>

<p>And so below we can see our ‘broken’ data. I’ve set the broken segment to be quite wide here and its very obvious the broken data is totally different. The hope is that in reality the model once trained would be good at picking up much more nuanced changes in the data that are less obvious to the human eye.</p>

<p>For example if all metrics were to suddenly become more or less correlated than normal but all still each move by a typical amount individually then this is the sort of change you’d like the model to highlight (this is probably something i should have tried to do when making the ‘broken’ data to make the whole example more realistic, feel free to try this yourself and let me know how you get on).</p>

<figure>

  <p><img src="/assets/images/2019-09-09-multi-variate-multi-step-lstm-for-anomaly-detection/1_UKqQRjsqMTPrRcpB7uEQbg.jpeg" alt="" /></p>

  <figcaption>

    <p>Same as the “normal” data but i’ve messed up a huge chunk of it.</p>

  </figcaption>

</figure>

<h2 id="some-helper-functions">Some Helper Functions</h2>

<p>I’ve built some helper functions to make life easier in the example notebook. I’ll share the code below and talk a little about each.</p>

<ul>
  <li><strong>data_reshape_for_model()</strong> : This function basically takes in an typical dataframe type array, loops through that data and reshapes it all into a numpy array of the shape expected by the keras LSTM model for both training and prediction. Figuring out how to reshape the data based on the N_TIMESTEPS, N_FEATURES and length of the data was actually probably the trickiest part of this whole example. I’ve noticed that many tutorials online just reshape the data but do so in an incomplete way by essentially just pairing off rows. But what you really want to do is step through all the rows to make sure you roll your N_TIMESTEPS window properly over the data to as to all possible windows in your training.</li>
  <li><strong>train()</strong> : This is just a simple wrapper for the keras train function. There is no real need for it.</li>
  <li><strong>predict()</strong> : Similar to train() is just a wrapper function that does not really do much.</li>
  <li><strong>model_data_to_df_long()</strong> : This function takes in a data array as used by the keras model and unrolls it into one big long pandas dataframe (numpy arrays freak me out a bit sometimes so i always try fall back pandas when i can get away with it 😉).</li>
  <li><strong>model_df_long_to_wide()</strong> : This function then takes the long format dataframe created by model_data_to_df_long() and converts it into a wide format that is closed to the original dataset of one row one observation and one column for each input feature (plus lots more columns for predictions for each feature for each timestep).</li>
  <li><strong>df_out_add_errors()</strong> : This function adds errors and error aggregation columns to the main df_out dataframe which stores all the predictions and errors for each original row of data.</li>
  <li><strong>yhat_to_df_out()</strong> : This function take’s in the model formatted training data and model formatted prediction outputs and wraps all the above functions to make a nice little “df_out” dataframe that has everything we want in it and is one row one observation so lines up more naturally with the original data.</li>
</ul>

<p>https://gist.github.com/andrewm4894/58179c6e240163a45dc2acff1843f7f2#file-keras_lstm_multi_helper_functions-py</p>

<h2 id="build--train-the-model">Build &amp; Train The Model</h2>

<p>Below code builds the model, trains it and also calls predict on all the training data be able to get errors on the original ‘normal’ training data.</p>

<p>https://gist.github.com/andrewm4894/48fa72cf730eead43f3ce54cdb3842cb#file-keras_lstm_multi_build_and_train-py</p>

<p>We then call our “do everything” yhat_to_df_out() function on the training data and the predictions from the model.</p>

<p>https://gist.github.com/andrewm4894/9b8c108661fc640325f6be774a0a1861#file-keras_lstm_multi_make_df_out-py</p>

<p>Now we can plot lots of things from df_out. For example here are the errors averaged across all five features are each timestep prediction horizon.</p>

<p>https://gist.github.com/andrewm4894/50bf96cc87ac37079c55516f4068a4b6#file-keras_lstm_multi_plot_error_avg-py</p>

<p><img src="/assets/images/2019-09-09-multi-variate-multi-step-lstm-for-anomaly-detection/1_6HBimTV7Bete2b2_iB9gTw.jpeg" alt="" /></p>

<p>In the above plot we can see the averaged error of the model on its training data. Each line represents a different forecast horizon. We can see that the lines are sort of ‘stacked’ on top of each other which makes sense as you’d generally expect the error 5 timesteps out (red line “t4_error_avg”) to be higher then the one step ahead forecast (greeny/orangy line “t0_error_avg”).</p>

<p>If we look at the standard deviation of our errors in a similar way, we can see how the standard deviation of our errors generally tends to increase at times when our 5 original features are diverging from each other as you can imagine these are the hardest parts of our time series for this model to predict.</p>

<p><img src="/assets/images/2019-09-09-multi-variate-multi-step-lstm-for-anomaly-detection/1_PuMxLqfI3xQkoTzNo44v1g.jpeg" alt="" /></p>

<h2 id="lets-break-it">Lets Break It</h2>

<p>So now that we have our model trained on our ‘normal’ data we can use it to see how well it does at predicting our new ‘broken’ data.</p>

<p>https://gist.github.com/andrewm4894/fdb8ac2b8e8624e2a13e84b399f0faa1#file-keras_lstm_multi_build_and_train_new_broken_data-py</p>

<figure>

  <p><img src="/assets/images/2019-09-09-multi-variate-multi-step-lstm-for-anomaly-detection/1_qB4T52kMb6VdRHsKT4gXbw.jpeg" alt="" /></p>

  <figcaption>

    <p>Here we can see that as soon as we hit the broken data the prediction errors go through the roof.</p>

  </figcaption>

</figure>

<p>From the above we can see that as soon as the random broken data comes into the time series the model prediction errors explode.</p>

<p>As mentioned, this is a very obvious and synthetic use case just for learning on but the main idea is that if your data changed in a more complicated and harder to spot way then your error rates would everywhere reflect this change. These error rates could then be used as input into a more global anomaly score for your system.</p>

<p>That’s it, thanks for reading and feel free to add any comments or questions below. I may add some more complicated or real world examples building on this approach at a later stage.</p>

<p><strong>UPDATE</strong>: <a href="https://colab.research.google.com/drive/1Mx2uoeGL3VRQLifNtrcPY0rABc1GY3ep">Here</a> is a Google Colab notebook that’s a bit better as i’ve worked a bit more on this since the original blog post.</p>


<style>
.cover-image {
  margin-bottom: 2em;
  max-width: 100%;
  overflow: hidden;
}

.cover-image img {
  width: 100%;
  height: auto;
  display: block;
}

.post-meta {
  color: #666;
  margin-bottom: 2em;
}

.category {
  font-style: italic;
}

figure {
  margin: 1.5em 0;
  text-align: center;
}

figure img {
  max-width: 100%;
  height: auto;
  display: block;
  margin: 0 auto;
}

figcaption {
  color: #666;
  font-style: italic;
  margin-top: 0.5em;
}

img {
  max-width: 100%;
  height: auto;
  display: block;
  margin: 1em auto;
}

code {
  padding: 0.2em 0.4em;
  background-color: #f6f8fa;
  border-radius: 3px;
  font-size: 85%;
}

pre code {
  padding: 0;
  background-color: transparent;
}

.language-plaintext {
  color: #24292e;
}

.language-python {
  color: #24292e;
}
</style> 

        <!-- Comments section -->
        <div id="comments" style="margin-top: 3em; margin-bottom: 2em;">
          <script src="https://giscus.app/client.js"
                  data-repo="andrewm4894/blog"
                  data-repo-id=""
                  data-category="General"
                  data-category-id=""
                  data-mapping="pathname"
                  data-strict="0"
                  data-reactions-enabled="1"
                  data-emit-metadata="0"
                  data-input-position="bottom"
                  data-theme="preferred_color_scheme"
                  data-lang="en"
                  crossorigin="anonymous"
                  async>
          </script>
        </div>

        <div style="margin-top: 2em; text-align: center;">
          <a href="/preview/dummy-feature-branch/" style="display: inline-block; margin: 1em;">← Back to Home</a>
        </div>
      </section>

      <!-- Right sidebar -->
      <aside style="width: 300px; margin-top: 6em;">
        <div style="position: sticky; top: 20px;">
          <h3 style="margin-top: 0;">Recent Posts</h3>
          <div class="posts-list">
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/dummy-feature-branch/2025/08/02/dummy-ci-test-post/" >
                    Dummy CI Test Post - Testing Feature Branch Previews
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  August 02, 2025
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/dummy-feature-branch/2024/12/19/bolt-new-vs-o1-some-thoughts/" >
                    bolt.new vs o1 - some thoughts
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  December 19, 2024
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/dummy-feature-branch/2024/12/03/anomstack-data-engineering-podcast/" >
                    Anomstack - Data Engineering Podcast
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  December 03, 2024
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/dummy-feature-branch/2024/03/04/weights-biases-log-keras-model-summary-architecture/" >
                    Weights &amp; Biases - log Keras model summary &amp; architecture
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  March 04, 2024
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/dummy-feature-branch/2023/12/20/mlops-community-podcast/" >
                    MLOps Community Podcast!!!
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  December 20, 2023
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/dummy-feature-branch/2023/11/06/the-future-of-machine-learning-and-ai-panel-discussion-civo-navigate-europe-23/" >
                    The Future of Machine Learning and AI Panel Discussion - Civo Navigate Europe 23
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  November 06, 2023
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/dummy-feature-branch/2023/10/25/10-practical-ml-use-cases-in-observability/" >
                    10 Practical ML Use Cases in Observability
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  October 25, 2023
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/dummy-feature-branch/2023/07/01/malloy-seems-petty-cool/" >
                    Malloy seems petty cool...
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  July 01, 2023
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/dummy-feature-branch/2023/05/18/painless-anomaly-detection-with-apache-airflow/" >
                    Painless Anomaly Detection with Apache Airflow
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  May 18, 2023
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/dummy-feature-branch/2022/12/22/stripe-webhook-gcp-functions-framework-python/" >
                    Stripe Webhook + GCP Functions Framework (Python)
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  December 22, 2022
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/dummy-feature-branch/2022/10/20/colab-to-just-run-some-curl/" >
                    Colab to just run some curl
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  October 20, 2022
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/dummy-feature-branch/2022/10/15/some-sort-of-livecoding/" >
                    Some sort-of livecoding
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  October 15, 2022
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/dummy-feature-branch/2022/09/02/explaining-kmeans-clustering-for-unsupervised-anomaly-detection/" >
                    Explaining kmeans clustering for unsupervised anomaly detection
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  September 02, 2022
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/dummy-feature-branch/2022/08/18/hugging-face-text-classification-quickstart/" >
                    Hugging Face Text Classification Quickstart
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  August 18, 2022
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/dummy-feature-branch/2022/07/01/airflow-trigger-dags-python-script/" >
                    Airflow "Trigger Dags" Python Script
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  July 01, 2022
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/dummy-feature-branch/2022/03/25/some-ml-hot-takes/" >
                    Some ML hot takes
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  March 25, 2022
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/dummy-feature-branch/2021/10/11/time-series-anomaly-detection-using-pca/" >
                    Time series anomaly detection using PCA
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  October 11, 2021
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/dummy-feature-branch/2021/05/27/streamlit-multi-page-app-minimal-example/" >
                    streamlit multi-page app minimal example
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  May 27, 2021
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/dummy-feature-branch/2021/03/25/some-asyncio-fun-pain/" >
                    Some asyncio fun/pain
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  March 25, 2021
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/dummy-feature-branch/2021/02/16/anomaly-detection-using-matrix-profile/" >
                    Anomaly Detection using the Matrix Profile
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  February 16, 2021
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/dummy-feature-branch/2021/01/29/machine-learning-ireland-slack-community/" >
                    "Machine Learning Ireland" slack community
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  January 29, 2021
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/dummy-feature-branch/2021/01/14/time-series-anomaly-detection-in-go-using-golearn/" >
                    Time series anomaly detection in Go using GoLearn
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  January 14, 2021
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/dummy-feature-branch/2021/01/03/anomaly-detection-resources/" >
                    Anomaly Detection Resources
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  January 03, 2021
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/dummy-feature-branch/2020/12/28/first-stab-at-some-go-so-hot-right-now/" >
                    First stab at some Go (so hot right now)
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  December 28, 2020
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/dummy-feature-branch/2020/12/02/anomaly-detection-tutorial/" >
                    Anomaly Detection Tutorial
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  December 02, 2020
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/dummy-feature-branch/2020/11/10/good-places-for-datasets/" >
                    Good Places For Datasets
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  November 10, 2020
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/dummy-feature-branch/2020/10/19/different-types-of-time-series-anomalies/" >
                    Different types of time series anomalies
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  October 19, 2020
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/dummy-feature-branch/2020/10/15/numpy-feature-engineering-2x-speed-up-over-pandas/" >
                    Numpy Feature Engineering - 2x Speed Up Over Pandas!
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  October 15, 2020
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/dummy-feature-branch/2020/09/29/market-basket-analysis-in-python/" >
                    Market basket analysis in Python
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  September 29, 2020
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/dummy-feature-branch/2020/09/18/i-helped-build-a-thing/" >
                    I helped build a thing!
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  September 18, 2020
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/dummy-feature-branch/2020/09/03/time-series-clustering-with-tslearn/" >
                    Time series clustering with tslearn
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  September 03, 2020
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/dummy-feature-branch/2020/06/05/premature-optimization/" >
                    Premature Optimization
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  June 05, 2020
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/dummy-feature-branch/2020/04/29/terraform-is-magic-r-machinelearning-links/" >
                    Terraform is Magic + r/MachineLearning Links
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  April 29, 2020
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/dummy-feature-branch/2020/03/23/ireland-covid19-data/" >
                    Ireland Covid19 Data
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  March 23, 2020
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/dummy-feature-branch/2020/02/27/a-little-brainteaser-or-im-an-idiot/" >
                    A little brainteaser (or i'm an idiot)
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  February 27, 2020
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/dummy-feature-branch/2020/02/20/papers-im-reading-2/" >
                    Papers i'm reading #2
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  February 20, 2020
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/dummy-feature-branch/2020/01/28/github-webhook-cloud-function-bigquery/" >
                    Github Webhook -> Cloud Function -> BigQuery
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  January 28, 2020
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/dummy-feature-branch/2019/12/30/papers-im-reading-1/" >
                    Papers i'm reading #1
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  December 30, 2019
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/dummy-feature-branch/2019/11/26/my-first-pypi-package/" >
                    My First PyPI Package
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  November 26, 2019
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/dummy-feature-branch/2019/10/20/kubeflow-custom-jupyter-image-github-for-notebook-source-control/" >
                    KubeFlow Custom Jupyter Image (+ github for notebook source control)
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  October 20, 2019
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/dummy-feature-branch/2019/09/09/multi-variate-multi-step-lstm-for-anomaly-detection/" class="current-post">
                    Multi-Variate, Multi-Step, LSTM for Anomaly Detection
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  September 09, 2019
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/dummy-feature-branch/2019/09/04/custom-python-packages-in-aws-lambda/" >
                    Custom Python Packages in AWS Lambda
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  September 04, 2019
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/dummy-feature-branch/2019/07/20/clustering-cell-tower-usage-data/" >
                    Clustering Cell Tower Usage Data
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  July 20, 2019
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/dummy-feature-branch/2019/07/04/parallelize-a-wide-df-in-pandas/" >
                    Parallelize a wide df in Pandas
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  July 04, 2019
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/dummy-feature-branch/2019/06/11/0-0-0-0/" >
                    ( 0 - 0 ) / 0 != 0
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  June 11, 2019
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/dummy-feature-branch/2019/05/01/java-hello-world-cli-using-args4j/" >
                    Java Hello World cli using args4j
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  May 01, 2019
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/dummy-feature-branch/2019/04/30/weka-adding-list-to-instances-object/" >
                    Java Weka API: Adding List To Instances Object
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  April 30, 2019
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/dummy-feature-branch/2019/04/27/parallel-jupyter-notebooks/" >
                    Parallel Jupyter Notebooks
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  April 27, 2019
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/dummy-feature-branch/2019/04/25/the-journey-begins/" >
                    My Site...
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  April 25, 2019
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/dummy-feature-branch/2019/04/25/previous-blog-posts/" >
                    Previous blog posts
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  April 25, 2019
                </time>
              </article>
            
            
              <p style="margin-top: 1em;">
                <a href="/preview/dummy-feature-branch/" style="color: #666;">View all posts →</a>
              </p>
            
          </div>
        </div>
      </aside>

      <style>
        /* Typography */
        body {
          font-family: 'Source Sans Pro', -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
          font-size: 16px;
          line-height: 1.6;
          color: #333;
        }
        
        h1, h2, h3, h4, h5, h6 {
          font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
          font-weight: 600;
          color: #1a1a1a;
          line-height: 1.3;
          margin-top: 2rem;
          margin-bottom: 1rem;
        }
        
        h1 { 
          font-size: 2.5rem; 
          font-weight: 700; 
          margin-top: 0; 
          margin-bottom: 1.5rem;
        }
        h2 { font-size: 2rem; }
        h3 { font-size: 1.5rem; }
        h4 { font-size: 1.25rem; }
        h5 { font-size: 1.125rem; }
        h6 { font-size: 1rem; }
        
        p {
          margin-bottom: 1.5rem;
          line-height: 1.7;
        }
        
        code, pre {
          font-family: 'JetBrains Mono', 'Fira Code', 'Courier New', monospace;
        }
        
        code {
          font-size: 0.9em;
          font-weight: 500;
        }
        
        pre {
          font-size: 0.85em;
          line-height: 1.5;
          overflow-x: auto;
          padding: 1rem;
          border-radius: 6px;
          background-color: #f8f9fa !important;
        }

        .cover-image {
          margin-bottom: 2em;
          max-width: 100%;
          overflow: hidden;
        }

        .cover-image img {
          width: 100%;
          height: auto;
          display: block;
        }

        .post-meta {
          color: #666;
          margin-bottom: 2em;
          font-size: 0.95rem;
        }

        .category {
          font-style: italic;
          font-weight: 500;
        }

        figure {
          margin: 1.5em 0;
          text-align: center;
        }

        figure img {
          max-width: 100%;
          height: auto;
          display: block;
          margin: 0 auto;
        }

        figcaption {
          color: #666;
          font-style: italic;
          margin-top: 0.5em;
          font-size: 0.9rem;
        }

        img {
          max-width: 100%;
          height: auto;
          display: block;
          margin: 1em auto;
        }

        code {
          padding: 0.2em 0.4em;
          background-color: #f6f8fa;
          border-radius: 3px;
          font-size: 85%;
        }

        pre code {
          padding: 0;
          background-color: transparent;
        }

        .language-plaintext {
          color: #24292e;
        }

        .language-python {
          color: #24292e;
        }

        .posts-list h4 a {
          color: #333;
          text-decoration: none;
          font-weight: 500;
        }

        .posts-list h4 a:hover {
          color: #267CB9;
        }

        .posts-list .current-post {
          color: #267CB9;
          font-weight: 600;
        }
        
        /* Improve link styling */
        a {
          color: #267CB9;
          text-decoration: none;
          transition: color 0.2s ease;
        }
        
        a:hover {
          color: #1e5a8a;
          text-decoration: underline;
        }

        @media screen and (max-width: 1000px) {
          .wrapper {
            flex-direction: column;
          }
          
          section {
            margin-right: 0;
          }

          aside {
            width: 100%;
            margin-top: 3em;
          }
          
          h1 { font-size: 2rem; }
          h2 { font-size: 1.75rem; }
          h3 { font-size: 1.5rem; }
        }
      </style>
    </div>
  </body>
</html> 