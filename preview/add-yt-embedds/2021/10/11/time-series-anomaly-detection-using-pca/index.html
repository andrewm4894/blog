<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Favicon -->
    <link rel="icon" type="image/png" href="/preview/add-yt-embedds/assets/images/favicon.png">
    <link rel="shortcut icon" type="image/png" href="/preview/add-yt-embedds/assets/images/favicon.png">
    <link rel="apple-touch-icon" href="/preview/add-yt-embedds/assets/images/favicon.png">

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Source+Sans+Pro:ital,wght@0,400;0,600;1,400;1,600&family=JetBrains+Mono:ital,wght@0,400;0,500;1,400;1,500&display=swap" rel="stylesheet">

    <title>Time series anomaly detection using PCA | andrewm4894.com</title>
    <link rel="stylesheet" href="/preview/add-yt-embedds/assets/css/style.css?v=20250802155631">
    
    <!-- PostHog Analytics -->
    <script>
        !function(t,e){var o,n,p,r;e.__SV||(window.posthog=e,e._i=[],e.init=function(i,s,a){function g(t,e){var o=e.split(".");2==o.length&&(t=t[o[0]],e=o[1]),t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}}(p=t.createElement("script")).type="text/javascript",p.crossOrigin="anonymous",p.async=!0,p.src=s.api_host.replace(".i.posthog.com","-assets.i.posthog.com")+"/static/array.js",(r=t.getElementsByTagName("script")[0]).parentNode.insertBefore(p,r);var u=e;for(void 0!==a?u=e[a]=[]:a="posthog",u.people=u.people||[],u.toString=function(t){var e="posthog";return"posthog"!==a&&(e+="."+a),t||(e+=" (stub)"),e},u.people.toString=function(){return u.toString(1)+".people (stub)"},o="init Re Cs Fs Pe Rs Ms capture Ve calculateEventProperties Ds register register_once register_for_session unregister unregister_for_session zs getFeatureFlag getFeatureFlagPayload isFeatureEnabled reloadFeatureFlags updateEarlyAccessFeatureEnrollment getEarlyAccessFeatures on onFeatureFlags onSurveysLoaded onSessionId getSurveys getActiveMatchingSurveys renderSurvey canRenderSurvey canRenderSurveyAsync identify setPersonProperties group resetGroups setPersonPropertiesForFlags resetPersonPropertiesForFlags setGroupPropertiesForFlags resetGroupPropertiesForFlags reset get_distinct_id getGroups get_session_id get_session_replay_url alias set_config startSessionRecording stopSessionRecording sessionRecordingStarted captureException loadToolbar get_property getSessionProperty js As createPersonProfile Ns Is Us opt_in_capturing opt_out_capturing has_opted_in_capturing has_opted_out_capturing clear_opt_in_out_capturing Os debug I Ls getPageViewId captureTraceFeedback captureTraceMetric".split(" "),n=0;n<o.length;n++)g(u,o[n]);e._i.push([i,s,a])},e.__SV=1)}(document,window.posthog||[]);
        posthog.init('zR4pStMtxgP3wJ27vIjQJvZNXwMWqZlzP0x4dKbHOHg', {
            api_host: 'https://us.i.posthog.com',
            defaults: '2025-05-24',
            person_profiles: 'identified_only', // or 'always' to create profiles for anonymous users as well
        })
    </script>
    
  </head>
  <body>
    <div class="wrapper" style="display: flex; max-width: 1200px; margin: 0 auto; padding: 0 20px;">
      <!-- Main content -->
      <section style="flex: 1; max-width: 800px; margin-right: 40px;">
        <div style="margin-bottom: 2em;">
          <a href="/preview/add-yt-embedds/" style="display: inline-block; padding: 0.5em 1em; background: #f5f5f5; border-radius: 4px; text-decoration: none; color: #333;">
            ← Back to Home
          </a>
        </div>

        

        <h1>Time series anomaly detection using PCA</h1>

        <p class="post-meta">
          <time datetime="2021-10-11T00:00:00+00:00">Oct 11, 2021
          </time><span class="categories">
            • Categories: 
            
            <span class="category">anomaly-detection</span>
            , 
            
            <span class="category">machine-learning</span>
            , 
            
            <span class="category">time-series</span>
            
            
          </span></p>

        <figure>

  <p><img src="/assets/images/2021-10-11-time-series-anomaly-detection-using-pca/image-4.png" alt="" /></p>

  <figcaption>

    <p>contaminated raw data vs anomaly score</p>

  </figcaption>

</figure>

<p>Here is a little recipe for using good old <a href="https://en.wikipedia.org/wiki/Principal_component_analysis">PCA</a> to do some fast and efficient time series anomaly detection.</p>

<p>The high level idea here is to:</p>

<ol>
  <li>“featurize” the time series data into a traditional feature vector based formulation over recent data.</li>
  <li>fit a PCA model on some “mostly” normal data.</li>
  <li>when new data arrives if the PCA model is not able to do a good enough job at representing that data then that could be a sign of some anomalous observations.</li>
  <li>use some min/max normalisation tricks on the training data to get a nice “anomaly score” on a 0-100 scale.</li>
</ol>

<p><strong>Note</strong>: You can run and play with <a href="https://github.com/andrewm4894/colabs/blob/master/time_series_anomaly_detection_with_pca.ipynb">this colab notebook</a> if you’d rather just look at the code (<a href="https://github.com/andrewm4894/colabs/blob/master/time_series_anomaly_detection_with_pca.ipynb">github</a>, <a href="https://colab.research.google.com/drive/1kp7a-FANlwHrAwT2F7IIt7Af-gnDYJ3b?usp=sharing">colab</a>).</p>

<h2 id="raw-data">Raw Data</h2>

<p>Let’s begin by getting some raw data to work with. Here i will use public data from a demo server at <a href="https://www.netdata.cloud/">Netdata Cloud</a> where i work. You can see this data on the <a href="http://london.my-netdata.io/">Netdata dashboard</a> here or via its api <a href="https://london.my-netdata.io/api/v1/data?chart=system.cpu&amp;after=-3600&amp;before=0">here</a> (which is what we will be using - albeit via our <a href="https://github.com/netdata/netdata-pandas">netdata_pandas</a> package that manages all that).</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># inputs 
</span><span class="n">host</span><span class="err"> </span><span class="o">=</span><span class="err"> </span><span class="s">'london.my-netdata.io'</span><span class="err">  </span><span class="c1"># pull from 'london' netdata demo host
</span><span class="n">after</span><span class="err"> </span><span class="o">=</span><span class="err"> </span><span class="o">-</span><span class="mi">3600</span><span class="err">  </span><span class="c1"># last 60 minutes
</span><span class="n">before</span><span class="err"> </span><span class="o">=</span><span class="err"> </span><span class="mi">0</span><span class="err">  </span><span class="c1"># starting from now
</span><span class="n">dims</span><span class="err"> </span><span class="o">=</span><span class="err"> </span><span class="p">[</span><span class="s">'system.cpu|system'</span><span class="p">]</span><span class="err">  </span><span class="c1"># lets just look at syatem cpu data
</span>
<span class="c1"># params
</span><span class="n">n_train</span><span class="err"> </span><span class="o">=</span><span class="err"> </span><span class="mi">3000</span><span class="err">  </span><span class="c1"># use the last 50 minutes of data to train on
</span><span class="n">diffs_n</span><span class="err"> </span><span class="o">=</span><span class="err"> </span><span class="mi">1</span><span class="err">  </span><span class="c1"># take differences
</span><span class="n">lags_n</span><span class="err"> </span><span class="o">=</span><span class="err"> </span><span class="mi">3</span><span class="err">  </span><span class="c1"># include 3 lags in the feature vector
</span><span class="n">smooth_n</span><span class="err"> </span><span class="o">=</span><span class="err"> </span><span class="mi">3</span><span class="err">  </span><span class="c1"># smooth the latest values to be included in the feature vector
</span>
<span class="c1"># get raw data
</span><span class="n">df</span><span class="err"> </span><span class="o">=</span><span class="err"> </span><span class="n">get_data</span><span class="p">(</span>
<span class="err">    </span><span class="n">hosts</span><span class="o">=</span><span class="p">[</span><span class="n">host</span><span class="p">],</span><span class="err"> </span>
<span class="err">    </span><span class="n">charts</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">d</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">'|'</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="err"> </span><span class="k">for</span><span class="err"> </span><span class="n">d</span><span class="err"> </span><span class="ow">in</span><span class="err"> </span><span class="n">dims</span><span class="p">])),</span><span class="err"> </span>
<span class="err">    </span><span class="n">after</span><span class="o">=</span><span class="n">after</span><span class="p">,</span><span class="err"> </span>
<span class="err">    </span><span class="n">before</span><span class="o">=</span><span class="n">before</span><span class="p">,</span><span class="err"> </span>
<span class="err">    </span><span class="n">index_as_datetime</span><span class="o">=</span><span class="bp">True</span>
<span class="p">)</span>
<span class="n">df</span><span class="err"> </span><span class="o">=</span><span class="err"> </span><span class="n">df</span><span class="p">[</span><span class="n">dims</span><span class="p">]</span>

<span class="c1"># look at raw data
</span><span class="k">print</span><span class="p">(</span><span class="n">df</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">.</span><span class="n">head</span><span class="p">())</span>
</code></pre></div></div>

<p>This gives us our raw data from the last 60 minutes that we will be using.</p>

<figure>

  <p><img src="/assets/images/2021-10-11-time-series-anomaly-detection-using-pca/image.png" alt="" /></p>

  <figcaption>

    <p>raw data</p>

  </figcaption>

</figure>

<h2 id="add-some-anomalies">Add some anomalies</h2>

<p>To make things easy on ourselves we will take a little snippet of time towards the end of our raw data and mess it up by first shuffling it and then smoothing it so that it’s clearly anomalous.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># create anomalous data
</span><span class="n">anomalous_len</span><span class="err"> </span><span class="o">=</span><span class="err"> </span><span class="nb">int</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="err"> </span><span class="o">-</span><span class="err"> </span><span class="n">n_train</span><span class="p">)</span><span class="err"> </span><span class="o">/</span><span class="err"> </span><span class="mi">2</span><span class="p">)</span><span class="err">  </span><span class="c1"># we pick half of our anomalous window to mess up
</span><span class="n">df_anomalous</span><span class="err"> </span><span class="o">=</span><span class="err"> </span><span class="n">df</span><span class="p">.</span><span class="n">tail</span><span class="p">(</span><span class="n">anomalous_len</span><span class="err"> </span><span class="o">+</span><span class="err"> </span><span class="n">anomalous_len</span><span class="p">)</span><span class="err">  </span><span class="c1"># get the tail end of our raw data
</span><span class="n">df_anomalous</span><span class="err"> </span><span class="o">=</span><span class="err"> </span><span class="n">df_anomalous</span><span class="p">.</span><span class="n">head</span><span class="p">(</span><span class="n">anomalous_len</span><span class="p">)</span><span class="err">  </span><span class="c1"># take the top part of it we want to mess with
</span><span class="n">df_anomalous</span><span class="p">[</span><span class="n">dims</span><span class="p">]</span><span class="err"> </span><span class="o">=</span><span class="err"> </span><span class="n">df_anomalous</span><span class="p">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mi">1</span><span class="p">).</span><span class="n">values</span><span class="err">  </span><span class="c1"># scramble the data
</span><span class="n">df_anomalous</span><span class="err"> </span><span class="o">=</span><span class="err"> </span><span class="n">df_anomalous</span><span class="p">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">60</span><span class="p">).</span><span class="n">mean</span><span class="p">()</span><span class="o">*</span><span class="mi">2</span><span class="err">  </span><span class="c1"># apply a 60 seconds rolling avg to smooth it so that it looks much different
</span>
<span class="c1"># append train data and anomalous data as 'contaminated' data
</span><span class="n">df_contaminated</span><span class="err"> </span><span class="o">=</span><span class="err"> </span><span class="n">df_train</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_anomalous</span><span class="p">).</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">.</span><span class="n">tail</span><span class="p">(</span><span class="n">anomalous_len</span><span class="p">)).</span><span class="n">interpolate</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s">'linear'</span><span class="p">)</span>
<span class="n">df_contaminated</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">'contaminated data'</span><span class="p">,</span><span class="err"> </span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span><span class="err"> </span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<p>Now we have data that look’s like below.</p>

<figure>

  <p><img src="/assets/images/2021-10-11-time-series-anomaly-detection-using-pca/image-1.png" alt="" /></p>

  <figcaption>

    <p>data with anomalous period added it</p>

  </figcaption>

</figure>

<h2 id="preprocessing">Preprocessing</h2>

<p>I have not mentioned it much but a key part of this “recipe” is in how we preprocess or featurize our raw time series data. We are keeping it simple here by ‘fattening’ our time series data at each timestep into a <em>differenced</em>, <em>smoothed</em> and <em>lagged</em> feature vector (which we also take absolute values of). This is typical basic feature preprocessing you might to when you want to convert your time series data into a more traditional ML formulation of observations of X’s and y’s.</p>

<p>I won’t talk about this much but <a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/">here</a> is a great blog post (all his stuff is great) that covers things in more detail.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">def</span><span class="err"> </span><span class="n">preprocess_df</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="err"> </span><span class="n">lags_n</span><span class="p">,</span><span class="err"> </span><span class="n">diffs_n</span><span class="p">,</span><span class="err"> </span><span class="n">smooth_n</span><span class="p">,</span><span class="err"> </span><span class="n">diffs_abs</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="err"> </span><span class="n">abs_features</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
<span class="err">    </span><span class="s">"""Given a pandas dataframe preprocess it to take differences, add smoothing, and lags as specified. 
    """</span>
<span class="err">    </span><span class="k">if</span><span class="err"> </span><span class="n">diffs_n</span><span class="err"> </span><span class="o">&gt;=</span><span class="err"> </span><span class="mi">1</span><span class="p">:</span>
<span class="err">        </span><span class="c1"># take differences
</span><span class="err">        </span><span class="n">df</span><span class="err"> </span><span class="o">=</span><span class="err"> </span><span class="n">df</span><span class="p">.</span><span class="n">diff</span><span class="p">(</span><span class="n">diffs_n</span><span class="p">).</span><span class="n">dropna</span><span class="p">()</span>
<span class="err">        </span><span class="c1"># abs diffs if defined
</span><span class="err">        </span><span class="k">if</span><span class="err"> </span><span class="n">diffs_abs</span><span class="err"> </span><span class="o">==</span><span class="err"> </span><span class="bp">True</span><span class="p">:</span>
<span class="err">            </span><span class="n">df</span><span class="err"> </span><span class="o">=</span><span class="err"> </span><span class="nb">abs</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="err">    </span><span class="k">if</span><span class="err"> </span><span class="n">smooth_n</span><span class="err"> </span><span class="o">&gt;=</span><span class="err"> </span><span class="mi">2</span><span class="p">:</span>
<span class="err">        </span><span class="c1"># apply a rolling average to smooth out the data a bit
</span><span class="err">        </span><span class="n">df</span><span class="err"> </span><span class="o">=</span><span class="err"> </span><span class="n">df</span><span class="p">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">smooth_n</span><span class="p">).</span><span class="n">mean</span><span class="p">().</span><span class="n">dropna</span><span class="p">()</span>
<span class="err">    </span><span class="k">if</span><span class="err"> </span><span class="n">lags_n</span><span class="err"> </span><span class="o">&gt;=</span><span class="err"> </span><span class="mi">1</span><span class="p">:</span>
<span class="err">        </span><span class="c1"># for each dimension add a new columns for each of lags_n lags of the differenced and smoothed values for that dimension
</span><span class="err">        </span><span class="n">df_columns_new</span><span class="err"> </span><span class="o">=</span><span class="err"> </span><span class="p">[</span><span class="sa">f</span><span class="s">'</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s">_lag</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s">'</span><span class="err"> </span><span class="k">for</span><span class="err"> </span><span class="n">n</span><span class="err"> </span><span class="ow">in</span><span class="err"> </span><span class="nb">range</span><span class="p">(</span><span class="n">lags_n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="err"> </span><span class="k">for</span><span class="err"> </span><span class="n">col</span><span class="err"> </span><span class="ow">in</span><span class="err"> </span><span class="n">df</span><span class="p">.</span><span class="n">columns</span><span class="p">]</span>
<span class="err">        </span><span class="n">df</span><span class="err"> </span><span class="o">=</span><span class="err"> </span><span class="n">pd</span><span class="p">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">.</span><span class="n">shift</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="err"> </span><span class="k">for</span><span class="err"> </span><span class="n">n</span><span class="err"> </span><span class="ow">in</span><span class="err"> </span><span class="nb">range</span><span class="p">(</span><span class="n">lags_n</span><span class="err"> </span><span class="o">+</span><span class="err"> </span><span class="mi">1</span><span class="p">)],</span><span class="err"> </span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">).</span><span class="n">dropna</span><span class="p">()</span>
<span class="err">        </span><span class="n">df</span><span class="p">.</span><span class="n">columns</span><span class="err"> </span><span class="o">=</span><span class="err"> </span><span class="n">df_columns_new</span>
<span class="err">    </span><span class="c1"># sort columns to have lagged values next to each other for clarity when looking at the feature vectors
</span><span class="err">    </span><span class="n">df</span><span class="err"> </span><span class="o">=</span><span class="err"> </span><span class="n">df</span><span class="p">.</span><span class="n">reindex</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">df</span><span class="p">.</span><span class="n">columns</span><span class="p">),</span><span class="err"> </span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="err">    </span><span class="c1"># abs all features if specified
</span><span class="err">    </span><span class="k">if</span><span class="err"> </span><span class="n">abs_features</span><span class="err"> </span><span class="o">==</span><span class="err"> </span><span class="bp">True</span><span class="p">:</span>
<span class="err">        </span><span class="n">df</span><span class="err"> </span><span class="o">=</span><span class="err"> </span><span class="nb">abs</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="err">    </span>
<span class="err">    </span><span class="k">return</span><span class="err"> </span><span class="n">df</span>

<span class="c1"># preprocess or 'featurize' the training data
</span><span class="n">train_data</span><span class="err"> </span><span class="o">=</span><span class="err"> </span><span class="n">preprocess_df</span><span class="p">(</span><span class="n">df_train</span><span class="p">,</span><span class="err"> </span><span class="n">lags_n</span><span class="p">,</span><span class="err"> </span><span class="n">diffs_n</span><span class="p">,</span><span class="err"> </span><span class="n">smooth_n</span><span class="p">)</span>

<span class="c1"># preprocess or 'featurize' the anomalous data
</span><span class="n">anomalous_data</span><span class="err"> </span><span class="o">=</span><span class="err"> </span><span class="n">preprocess_df</span><span class="p">(</span><span class="n">df_anomalous</span><span class="p">,</span><span class="err"> </span><span class="n">lags_n</span><span class="p">,</span><span class="err"> </span><span class="n">diffs_n</span><span class="p">,</span><span class="err"> </span><span class="n">smooth_n</span><span class="p">)</span>

<span class="c1"># preprocess or 'featurize' the contaminated data
</span><span class="n">contaminated_data</span><span class="err"> </span><span class="o">=</span><span class="err"> </span><span class="n">preprocess_df</span><span class="p">(</span><span class="n">df_contaminated</span><span class="p">,</span><span class="err"> </span><span class="n">lags_n</span><span class="p">,</span><span class="err"> </span><span class="n">diffs_n</span><span class="p">,</span><span class="err"> </span><span class="n">smooth_n</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="pca-ftw">PCA FTW!</h2>

<p>Now lets fit our PCA model on our training data and then use it to derive some anomaly scores for our anomalous data.</p>

<p>First we need to define exactly how we are going to use the PCA model to derive our anomaly scores.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">def</span><span class="err"> </span><span class="n">anomaly_scores</span><span class="p">(</span><span class="n">pca</span><span class="p">,</span><span class="err"> </span><span class="n">X</span><span class="p">):</span>
<span class="err">    </span><span class="s">"""Given a fitted pca model and some X feature vectors, compute an anomaly score as the sum of weighted euclidean distance between each sample to the
    hyperplane constructed by the selected eigenvectors. 
    """</span>
<span class="err">    </span><span class="k">return</span><span class="err"> </span><span class="n">np</span><span class="p">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">cdist</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="err"> </span><span class="n">pca</span><span class="p">.</span><span class="n">components_</span><span class="p">)</span><span class="err"> </span><span class="o">/</span><span class="err"> </span><span class="n">pca</span><span class="p">.</span><span class="n">explained_variance_ratio_</span><span class="p">,</span><span class="err"> </span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">).</span><span class="n">ravel</span><span class="p">()</span>
</code></pre></div></div>

<p>The function above takes in a fitted PCA and X vector of feature vectors and then computes a weighted distance measure between the features and the principle components. In a hand wavy sense the idea here is to measure the reconstruction error between the features X and our learned lower level representation of them that is implied via the fitted PCA mode (more details and references can be found in the awesome <a href="https://pyod.readthedocs.io/en/latest/_modules/pyod/models/pca.html">PyOD docs</a> - p.s. if you can you should just use PyOD as it has lots of different models implemented).</p>

<p>Now all we have to do is train or model, score our contaminated data and then apply our last little trick of min/max normalizing the raw anomaly scores based on the scores observed within the training data.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># build PCA model
</span><span class="n">pca</span><span class="err"> </span><span class="o">=</span><span class="err"> </span><span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># scale based on training data
</span><span class="n">scaler</span><span class="err"> </span><span class="o">=</span><span class="err"> </span><span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">scaler</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_data</span><span class="p">)</span>

<span class="c1"># fit model
</span><span class="n">pca</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">scaler</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">train_data</span><span class="p">))</span>

<span class="c1"># get anomaly scores for training data
</span><span class="n">train_scores</span><span class="err"> </span><span class="o">=</span><span class="err"> </span><span class="n">anomaly_scores</span><span class="p">(</span><span class="n">pca</span><span class="p">,</span><span class="err"> </span><span class="n">scaler</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">train_data</span><span class="p">))</span>
<span class="n">df_train_scores</span><span class="err"> </span><span class="o">=</span><span class="err"> </span><span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">train_scores</span><span class="p">,</span><span class="err"> </span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'anomaly_score'</span><span class="p">],</span><span class="err"> </span><span class="n">index</span><span class="o">=</span><span class="n">train_data</span><span class="p">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">df_train_scores_min</span><span class="err"> </span><span class="o">=</span><span class="err"> </span><span class="n">df_train_scores</span><span class="p">.</span><span class="nb">min</span><span class="p">()</span>
<span class="n">df_train_scores_max</span><span class="err"> </span><span class="o">=</span><span class="err"> </span><span class="n">df_train_scores</span><span class="p">.</span><span class="nb">max</span><span class="p">()</span>

<span class="c1"># normalize anomaly scores on based training data
</span><span class="n">df_train_scores</span><span class="err"> </span><span class="o">=</span><span class="err"> </span><span class="p">(</span><span class="err"> </span><span class="n">df_train_scores</span><span class="err"> </span><span class="o">-</span><span class="err"> </span><span class="n">df_train_scores_min</span><span class="err"> </span><span class="p">)</span><span class="err"> </span><span class="o">/</span><span class="err"> </span><span class="p">(</span><span class="err"> </span><span class="n">df_train_scores_max</span><span class="err"> </span><span class="o">-</span><span class="err"> </span><span class="n">df_train_scores_min</span><span class="err"> </span><span class="p">)</span>

<span class="c1"># score all contaminated data
</span><span class="n">contaminated_scores</span><span class="err"> </span><span class="o">=</span><span class="err"> </span><span class="n">anomaly_scores</span><span class="p">(</span><span class="n">pca</span><span class="p">,</span><span class="err"> </span><span class="n">scaler</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">contaminated_data</span><span class="p">))</span>
<span class="n">df_contaminated_scores</span><span class="err"> </span><span class="o">=</span><span class="err"> </span><span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">contaminated_scores</span><span class="p">,</span><span class="err"> </span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'anomaly_score'</span><span class="p">],</span><span class="err"> </span><span class="n">index</span><span class="o">=</span><span class="n">contaminated_data</span><span class="p">.</span><span class="n">index</span><span class="p">)</span>

<span class="c1"># normalize based on train data scores
</span><span class="n">df_contaminated_scores</span><span class="err"> </span><span class="o">=</span><span class="err"> </span><span class="p">(</span><span class="err"> </span><span class="n">df_contaminated_scores</span><span class="err"> </span><span class="o">-</span><span class="err"> </span><span class="n">df_train_scores_min</span><span class="err"> </span><span class="p">)</span><span class="err"> </span><span class="o">/</span><span class="err"> </span><span class="p">(</span><span class="err"> </span><span class="n">df_train_scores_max</span><span class="err"> </span><span class="o">-</span><span class="err"> </span><span class="n">df_train_scores_min</span><span class="err"> </span><span class="p">)</span>
</code></pre></div></div>

<p>Now we can see we have our lovely normalized anomaly scores as below where we can see a clear elevation in the anomaly score during our anomalous window.</p>

<figure>

  <p><img src="/assets/images/2021-10-11-time-series-anomaly-detection-using-pca/image-2.png" alt="" /></p>

  <figcaption>

    <p>normalized anomaly scores</p>

  </figcaption>

</figure>

<p>As one last little bit of post processing we can apply a rolling average to our normalized anomaly scores to try and make our anomalous window stand out a little more.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_contaminated_scores_smoothed</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">'contaminated data - smoothed anomaly score'</span><span class="p">,</span><span class="err"> </span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span><span class="err"> </span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<figure>

  <p><img src="/assets/images/2021-10-11-time-series-anomaly-detection-using-pca/image-3.png" alt="" /></p>

  <figcaption>

    <p>smoothed normalized anomaly scores</p>

  </figcaption>

</figure>

<p>And there you have it, a fairly simple recipe with a bit of sensible feature engineering, good old reliable PCA, little normalization trick and you have a fairly robust, efficient and easy to implement anomaly detection playbook.</p>


<style>
.cover-image {
  margin-bottom: 2em;
  max-width: 100%;
  overflow: hidden;
}

.cover-image img {
  width: 100%;
  height: auto;
  display: block;
}

.post-meta {
  color: #666;
  margin-bottom: 2em;
}

.category {
  font-style: italic;
}

figure {
  margin: 1.5em 0;
  text-align: center;
}

figure img {
  max-width: 100%;
  height: auto;
  display: block;
  margin: 0 auto;
}

figcaption {
  color: #666;
  font-style: italic;
  margin-top: 0.5em;
}

img {
  max-width: 100%;
  height: auto;
  display: block;
  margin: 1em auto;
}

code {
  padding: 0.2em 0.4em;
  background-color: #f6f8fa;
  border-radius: 3px;
  font-size: 85%;
}

pre code {
  padding: 0;
  background-color: transparent;
}

.language-plaintext {
  color: #24292e;
}

.language-python {
  color: #24292e;
}
</style> 

        <!-- Comments section -->
        <div id="comments" style="margin-top: 3em; margin-bottom: 2em;">
          <script src="https://giscus.app/client.js"
                  data-repo="andrewm4894/blog"
                  data-repo-id=""
                  data-category="General"
                  data-category-id=""
                  data-mapping="pathname"
                  data-strict="0"
                  data-reactions-enabled="1"
                  data-emit-metadata="0"
                  data-input-position="bottom"
                  data-theme="preferred_color_scheme"
                  data-lang="en"
                  crossorigin="anonymous"
                  async>
          </script>
        </div>

        <div style="margin-top: 2em; text-align: center;">
          <a href="/preview/add-yt-embedds/" style="display: inline-block; margin: 1em;">← Back to Home</a>
        </div>
      </section>

      <!-- Right sidebar -->
      <aside style="width: 300px; margin-top: 6em;">
        <div style="position: sticky; top: 20px;">
          <h3 style="margin-top: 0;">Recent Posts</h3>
          <div class="posts-list">
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/add-yt-embedds/2024/12/19/bolt-new-vs-o1-some-thoughts/" >
                    bolt.new vs o1 - some thoughts
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  December 19, 2024
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/add-yt-embedds/2024/12/03/anomstack-data-engineering-podcast/" >
                    Anomstack - Data Engineering Podcast
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  December 03, 2024
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/add-yt-embedds/2024/03/04/weights-biases-log-keras-model-summary-architecture/" >
                    Weights &amp; Biases - log Keras model summary &amp; architecture
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  March 04, 2024
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/add-yt-embedds/2023/12/20/mlops-community-podcast/" >
                    MLOps Community Podcast!!!
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  December 20, 2023
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/add-yt-embedds/2023/11/06/the-future-of-machine-learning-and-ai-panel-discussion-civo-navigate-europe-23/" >
                    The Future of Machine Learning and AI Panel Discussion - Civo Navigate Europe 23
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  November 06, 2023
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/add-yt-embedds/2023/10/25/10-practical-ml-use-cases-in-observability/" >
                    10 Practical ML Use Cases in Observability
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  October 25, 2023
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/add-yt-embedds/2023/07/01/malloy-seems-petty-cool/" >
                    Malloy seems petty cool...
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  July 01, 2023
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/add-yt-embedds/2023/05/18/painless-anomaly-detection-with-apache-airflow/" >
                    Painless Anomaly Detection with Apache Airflow
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  May 18, 2023
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/add-yt-embedds/2022/12/22/stripe-webhook-gcp-functions-framework-python/" >
                    Stripe Webhook + GCP Functions Framework (Python)
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  December 22, 2022
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/add-yt-embedds/2022/10/20/colab-to-just-run-some-curl/" >
                    Colab to just run some curl
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  October 20, 2022
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/add-yt-embedds/2022/10/15/some-sort-of-livecoding/" >
                    Some sort-of livecoding
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  October 15, 2022
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/add-yt-embedds/2022/09/02/explaining-kmeans-clustering-for-unsupervised-anomaly-detection/" >
                    Explaining kmeans clustering for unsupervised anomaly detection
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  September 02, 2022
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/add-yt-embedds/2022/08/18/hugging-face-text-classification-quickstart/" >
                    Hugging Face Text Classification Quickstart
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  August 18, 2022
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/add-yt-embedds/2022/07/01/airflow-trigger-dags-python-script/" >
                    Airflow "Trigger Dags" Python Script
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  July 01, 2022
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/add-yt-embedds/2022/03/25/some-ml-hot-takes/" >
                    Some ML hot takes
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  March 25, 2022
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/add-yt-embedds/2021/10/11/time-series-anomaly-detection-using-pca/" class="current-post">
                    Time series anomaly detection using PCA
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  October 11, 2021
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/add-yt-embedds/2021/05/27/streamlit-multi-page-app-minimal-example/" >
                    streamlit multi-page app minimal example
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  May 27, 2021
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/add-yt-embedds/2021/03/25/some-asyncio-fun-pain/" >
                    Some asyncio fun/pain
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  March 25, 2021
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/add-yt-embedds/2021/02/16/anomaly-detection-using-matrix-profile/" >
                    Anomaly Detection using the Matrix Profile
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  February 16, 2021
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/add-yt-embedds/2021/01/29/machine-learning-ireland-slack-community/" >
                    "Machine Learning Ireland" slack community
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  January 29, 2021
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/add-yt-embedds/2021/01/14/time-series-anomaly-detection-in-go-using-golearn/" >
                    Time series anomaly detection in Go using GoLearn
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  January 14, 2021
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/add-yt-embedds/2021/01/03/anomaly-detection-resources/" >
                    Anomaly Detection Resources
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  January 03, 2021
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/add-yt-embedds/2020/12/28/first-stab-at-some-go-so-hot-right-now/" >
                    First stab at some Go (so hot right now)
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  December 28, 2020
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/add-yt-embedds/2020/12/02/anomaly-detection-tutorial/" >
                    Anomaly Detection Tutorial
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  December 02, 2020
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/add-yt-embedds/2020/11/10/good-places-for-datasets/" >
                    Good Places For Datasets
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  November 10, 2020
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/add-yt-embedds/2020/10/19/different-types-of-time-series-anomalies/" >
                    Different types of time series anomalies
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  October 19, 2020
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/add-yt-embedds/2020/10/15/numpy-feature-engineering-2x-speed-up-over-pandas/" >
                    Numpy Feature Engineering - 2x Speed Up Over Pandas!
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  October 15, 2020
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/add-yt-embedds/2020/09/29/market-basket-analysis-in-python/" >
                    Market basket analysis in Python
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  September 29, 2020
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/add-yt-embedds/2020/09/18/i-helped-build-a-thing/" >
                    I helped build a thing!
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  September 18, 2020
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/add-yt-embedds/2020/09/03/time-series-clustering-with-tslearn/" >
                    Time series clustering with tslearn
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  September 03, 2020
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/add-yt-embedds/2020/06/05/premature-optimization/" >
                    Premature Optimization
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  June 05, 2020
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/add-yt-embedds/2020/04/29/terraform-is-magic-r-machinelearning-links/" >
                    Terraform is Magic + r/MachineLearning Links
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  April 29, 2020
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/add-yt-embedds/2020/03/23/ireland-covid19-data/" >
                    Ireland Covid19 Data
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  March 23, 2020
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/add-yt-embedds/2020/02/27/a-little-brainteaser-or-im-an-idiot/" >
                    A little brainteaser (or i'm an idiot)
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  February 27, 2020
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/add-yt-embedds/2020/02/20/papers-im-reading-2/" >
                    Papers i'm reading #2
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  February 20, 2020
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/add-yt-embedds/2020/01/28/github-webhook-cloud-function-bigquery/" >
                    Github Webhook -> Cloud Function -> BigQuery
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  January 28, 2020
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/add-yt-embedds/2019/12/30/papers-im-reading-1/" >
                    Papers i'm reading #1
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  December 30, 2019
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/add-yt-embedds/2019/11/26/my-first-pypi-package/" >
                    My First PyPI Package
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  November 26, 2019
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/add-yt-embedds/2019/10/20/kubeflow-custom-jupyter-image-github-for-notebook-source-control/" >
                    KubeFlow Custom Jupyter Image (+ github for notebook source control)
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  October 20, 2019
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/add-yt-embedds/2019/09/09/multi-variate-multi-step-lstm-for-anomaly-detection/" >
                    Multi-Variate, Multi-Step, LSTM for Anomaly Detection
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  September 09, 2019
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/add-yt-embedds/2019/09/04/custom-python-packages-in-aws-lambda/" >
                    Custom Python Packages in AWS Lambda
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  September 04, 2019
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/add-yt-embedds/2019/07/20/clustering-cell-tower-usage-data/" >
                    Clustering Cell Tower Usage Data
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  July 20, 2019
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/add-yt-embedds/2019/07/04/parallelize-a-wide-df-in-pandas/" >
                    Parallelize a wide df in Pandas
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  July 04, 2019
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/add-yt-embedds/2019/06/11/0-0-0-0/" >
                    ( 0 - 0 ) / 0 != 0
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  June 11, 2019
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/add-yt-embedds/2019/05/01/java-hello-world-cli-using-args4j/" >
                    Java Hello World cli using args4j
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  May 01, 2019
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/add-yt-embedds/2019/04/30/weka-adding-list-to-instances-object/" >
                    Java Weka API: Adding List To Instances Object
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  April 30, 2019
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/add-yt-embedds/2019/04/27/parallel-jupyter-notebooks/" >
                    Parallel Jupyter Notebooks
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  April 27, 2019
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/add-yt-embedds/2019/04/25/the-journey-begins/" >
                    My Site...
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  April 25, 2019
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/add-yt-embedds/2019/04/25/previous-blog-posts/" >
                    Previous blog posts
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  April 25, 2019
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/preview/add-yt-embedds/2019/04/25/java-for-machine-learning/" >
                    Java for Machine Learning
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  April 25, 2019
                </time>
              </article>
            
            
          </div>
        </div>
      </aside>

      <style>
        /* Typography */
        body {
          font-family: 'Source Sans Pro', -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
          font-size: 16px;
          line-height: 1.6;
          color: #333;
        }
        
        h1, h2, h3, h4, h5, h6 {
          font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
          font-weight: 600;
          color: #1a1a1a;
          line-height: 1.3;
          margin-top: 2rem;
          margin-bottom: 1rem;
        }
        
        h1 { 
          font-size: 2.5rem; 
          font-weight: 700; 
          margin-top: 0; 
          margin-bottom: 1.5rem;
        }
        h2 { font-size: 2rem; }
        h3 { font-size: 1.5rem; }
        h4 { font-size: 1.25rem; }
        h5 { font-size: 1.125rem; }
        h6 { font-size: 1rem; }
        
        p {
          margin-bottom: 1.5rem;
          line-height: 1.7;
        }
        
        code, pre {
          font-family: 'JetBrains Mono', 'Fira Code', 'Courier New', monospace;
        }
        
        code {
          font-size: 0.9em;
          font-weight: 500;
        }
        
        pre {
          font-size: 0.85em;
          line-height: 1.5;
          overflow-x: auto;
          padding: 1rem;
          border-radius: 6px;
          background-color: #f8f9fa !important;
        }

        .cover-image {
          margin-bottom: 2em;
          max-width: 100%;
          overflow: hidden;
        }

        .cover-image img {
          width: 100%;
          height: auto;
          display: block;
        }

        .post-meta {
          color: #666;
          margin-bottom: 2em;
          font-size: 0.95rem;
        }

        .category {
          font-style: italic;
          font-weight: 500;
        }

        figure {
          margin: 1.5em 0;
          text-align: center;
        }

        figure img {
          max-width: 100%;
          height: auto;
          display: block;
          margin: 0 auto;
        }

        figcaption {
          color: #666;
          font-style: italic;
          margin-top: 0.5em;
          font-size: 0.9rem;
        }

        img {
          max-width: 100%;
          height: auto;
          display: block;
          margin: 1em auto;
        }

        code {
          padding: 0.2em 0.4em;
          background-color: #f6f8fa;
          border-radius: 3px;
          font-size: 85%;
        }

        pre code {
          padding: 0;
          background-color: transparent;
        }

        .language-plaintext {
          color: #24292e;
        }

        .language-python {
          color: #24292e;
        }

        .posts-list h4 a {
          color: #333;
          text-decoration: none;
          font-weight: 500;
        }

        .posts-list h4 a:hover {
          color: #267CB9;
        }

        .posts-list .current-post {
          color: #267CB9;
          font-weight: 600;
        }
        
        /* Improve link styling */
        a {
          color: #267CB9;
          text-decoration: none;
          transition: color 0.2s ease;
        }
        
        a:hover {
          color: #1e5a8a;
          text-decoration: underline;
        }

        @media screen and (max-width: 1000px) {
          .wrapper {
            flex-direction: column;
          }
          
          section {
            margin-right: 0;
          }

          aside {
            width: 100%;
            margin-top: 3em;
          }
          
          h1 { font-size: 2rem; }
          h2 { font-size: 1.75rem; }
          h3 { font-size: 1.5rem; }
        }
      </style>
    </div>
  </body>
</html> 