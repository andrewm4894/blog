<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>KubeFlow Custom Jupyter Image (+ github for notebook source control) | Andrew M Blog</title>
    <link rel="stylesheet" href="/assets/css/style.css?v=">
  </head>
  <body>
    <div class="wrapper" style="display: flex; max-width: 1200px; margin: 0 auto; padding: 0 20px;">
      <!-- Main content -->
      <section style="flex: 1; max-width: 800px; margin-right: 40px;">
        <div style="margin-bottom: 2em;">
          <a href="/" style="display: inline-block; padding: 0.5em 1em; background: #f5f5f5; border-radius: 4px; text-decoration: none; color: #333;">
            ← Back to Home
          </a>
        </div>

        

        <h1>KubeFlow Custom Jupyter Image (+ github for notebook source control)</h1>

        <p class="post-meta">
          <time datetime="2019-10-20T00:00:00+01:00">Oct 20, 2019
          </time><span class="categories">
            • Categories: 
            
            <span class="category">kubeflow</span>
            , 
            
            <span class="category">machine-learning</span>
            
            
          </span></p>

        
        
        

<h1>KubeFlow Custom Jupyter Image (+ github for notebook source control)</h1>

<p class="post-meta">
  <time datetime="2019-10-20T00:00:00+01:00">Oct 20, 2019
  </time><span class="categories">
    • Categories: 
    
    <span class="category">kubeflow</span>
    , 
    
    <span class="category">machine-learning</span>
    
    
  </span></p>



<p>I’ve been playing around a bit with <a href="https://www.kubeflow.org/">KubeFlow</a> a bit lately and found that a lot of the tutorials and <a href="https://github.com/kubeflow/examples/blob/master/pipelines/simple-notebook-pipeline/Simple%20Notebook%20Pipeline.ipynb">examples</a> of Jupyter notebooks on KubeFlow do a lot of the <code class="language-plaintext highlighter-rouge">pip install</code> and other sort of setup and config stuff in the notebook itself which feels icky.</p>

<p><img src="/assets/images/2019-10-20-kubeflow-custom-jupyter-image-github-for-notebook-source-control/3duv0s.jpg" alt="" /></p>

<p>But, in reality, if you were working in Jupyter notebooks on KubeFlow for real you’d want to build a lot of this into the image used to build the notebook server. Luckily, as with most of KubeFlow, its pretty flexible to customize and extend as you want, in this case by adding <a href="https://www.kubeflow.org/docs/notebooks/custom-notebook/">custom jupyter images</a>.</p>

<p>Two main example use cases you’d want to do this are for ensuring some custom python package (e.g. <a href="https://github.com/andrewm4894/my_utils">my_utils</a>) you have built is readily available in all your notebooks, and other external libraries that you use all the time are also available - e.g. <a href="https://pypi.org/project/kfp/">kubeflow pipelines</a>.</p>

<p>To that end, <a href="https://github.com/andrewm4894/my-kf-jupyter/blob/master/Dockerfile">here</a> is a Dockerfile that illustrates this (and <a href="https://cloud.docker.com/repository/docker/andrewm4894/my-kf-jupyter">here</a> is corresponding image on docker hub).</p>

<p>https://gist.github.com/andrewm4894/ff38b48382d4f4a70734ef47ad974015</p>

<p>Once you have such a custom image building fine it’s pretty easy to just point KubeFlow at it when creating a Jupyter notebook server.</p>

<figure>

<img src="/assets/images/2019-10-20-kubeflow-custom-jupyter-image-github-for-notebook-source-control/Capture.png

<figcaption>

Just specify your custom image

</figcaption>

</figure>

<p>Now when you create a new workbook on that jupyter server you have all your custom goodness ready to go.</p>

<h2 id="github-for-notebooks">Github for notebooks</h2>

<p>As i was looking around it seems like there is currently plans to implement some git functionality into the notebooks on KubeFlow in a bit more of a native way (see <a href="https://github.com/kubeflow/kubeflow/issues/2889">this issue</a>).</p>

<p>For now i decided to just create a ssh key (<a href="https://help.github.com/en/articles/connecting-to-github-with-ssh">help docs</a>) for the persistent workspace volume connected to the notebook server (see step 10 <a href="https://www.kubeflow.org/docs/notebooks/setup/">here</a>).</p>

<p>Then once you want to <code class="language-plaintext highlighter-rouge">git push</code> from your notebook server you can just hack together a little notebook <a href="https://github.com/andrewm4894/my-kf-notebooks/blob/master/git.ipynb">like this</a> that you can use as a poor man’s git ui :)</p>


<style>
.cover-image {
  margin-bottom: 2em;
  max-width: 100%;
  overflow: hidden;
}

.cover-image img {
  width: 100%;
  height: auto;
  display: block;
}

.post-meta {
  color: #666;
  margin-bottom: 2em;
}

.category {
  font-style: italic;
}

figure {
  margin: 1.5em 0;
  text-align: center;
}

figure img {
  max-width: 100%;
  height: auto;
  display: block;
  margin: 0 auto;
}

figcaption {
  color: #666;
  font-style: italic;
  margin-top: 0.5em;
}

img {
  max-width: 100%;
  height: auto;
  display: block;
  margin: 1em auto;
}

code {
  padding: 0.2em 0.4em;
  background-color: #f6f8fa;
  border-radius: 3px;
  font-size: 85%;
}

pre code {
  padding: 0;
  background-color: transparent;
}

.language-plaintext {
  color: #24292e;
}

.language-python {
  color: #24292e;
}
</style> 

        <div style="margin-top: 2em; text-align: center;">
          <a href="/" style="display: inline-block; margin: 1em;">← Back to Home</a>
        </div>
      </section>

      <!-- Right sidebar -->
      <aside style="width: 300px; margin-top: 6em;">
        <div style="position: sticky; top: 20px;">
          <h3 style="margin-top: 0;">Recent Posts</h3>
          <div class="posts-list">
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/2024/12/19/bolt-new-vs-o1-some-thoughts/" >
                    bolt.new vs o1 - some thoughts
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  December 19, 2024
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/2024/12/03/anomstack-data-engineering-podcast/" >
                    Anomstack - Data Engineering Podcast
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  December 03, 2024
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/2024/03/04/weights-biases-log-keras-model-summary-architecture/" >
                    Weights &amp; Biases - log Keras model summary &amp; architecture
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  March 04, 2024
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/2023/12/20/mlops-community-podcast/" >
                    MLOps Community Podcast!!!
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  December 20, 2023
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/2023/11/06/the-future-of-machine-learning-and-ai-panel-discussion-civo-navigate-europe-23/" >
                    The Future of Machine Learning and AI Panel Discussion - Civo Navigate Europe 23
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  November 06, 2023
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/2023/10/25/10-practical-ml-use-cases-in-observability/" >
                    10 Practical ML Use Cases in Observability
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  October 25, 2023
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/2023/07/01/malloy-seems-petty-cool/" >
                    Malloy seems petty cool...
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  July 01, 2023
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/2023/05/18/painless-anomaly-detection-with-apache-airflow/" >
                    Painless Anomaly Detection with Apache Airflow
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  May 18, 2023
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/2022/12/22/stripe-webhook-gcp-functions-framework-python/" >
                    Stripe Webhook + GCP Functions Framework (Python)
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  December 22, 2022
                </time>
              </article>
            
              <article style="margin-bottom: 1.5em;">
                <h4 style="margin: 0;">
                  <a href="/2022/10/20/colab-to-just-run-some-curl/" >
                    Colab to just run some curl
                  </a>
                </h4>
                <time style="font-size: 0.9em; color: #666;">
                  October 20, 2022
                </time>
              </article>
            
            
              <p style="margin-top: 1em;">
                <a href="/" style="color: #666;">View all posts →</a>
              </p>
            
          </div>
        </div>
      </aside>

      <style>
        .cover-image {
          margin-bottom: 2em;
          max-width: 100%;
          overflow: hidden;
        }

        .cover-image img {
          width: 100%;
          height: auto;
          display: block;
        }

        .post-meta {
          color: #666;
          margin-bottom: 2em;
        }

        .category {
          font-style: italic;
        }

        figure {
          margin: 1.5em 0;
          text-align: center;
        }

        figure img {
          max-width: 100%;
          height: auto;
          display: block;
          margin: 0 auto;
        }

        figcaption {
          color: #666;
          font-style: italic;
          margin-top: 0.5em;
        }

        img {
          max-width: 100%;
          height: auto;
          display: block;
          margin: 1em auto;
        }

        code {
          padding: 0.2em 0.4em;
          background-color: #f6f8fa;
          border-radius: 3px;
          font-size: 85%;
        }

        pre code {
          padding: 0;
          background-color: transparent;
        }

        .language-plaintext {
          color: #24292e;
        }

        .language-python {
          color: #24292e;
        }

        .posts-list h4 a {
          color: #333;
          text-decoration: none;
        }

        .posts-list h4 a:hover {
          color: #267CB9;
        }

        .posts-list .current-post {
          color: #267CB9;
          font-weight: bold;
        }

        @media screen and (max-width: 1000px) {
          .wrapper {
            flex-direction: column;
          }
          
          section {
            margin-right: 0;
          }

          aside {
            width: 100%;
            margin-top: 3em;
          }
        }
      </style>
    </div>
  </body>
</html> 